(this.webpackJsonpgovtest=this.webpackJsonpgovtest||[]).push([[0],{146:function(e,t,n){},147:function(e,t,n){},155:function(e,t,n){},159:function(e,t,n){},164:function(e,t,n){},165:function(e,t,n){},168:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(14),s=n.n(c),i=(n(146),n(65)),o=n(18),l=(n(147),n(17)),u=n.n(l),d=n(23),j=n(7),h=n(103),b=n(44),m=n(175),p=n(74),f=n.p+"static/media/login_bg.482d8066.png",O="https://mxz0fg1wda.execute-api.ap-southeast-1.amazonaws.com",x=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(O,"/v1/auth/get_otp_email"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({email:t})});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(O,"/v1/auth/get_jwt_token"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({email:t,otp:n})});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(O,"/v1/auth/get_apps"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=n(63),w="USER_STORE",y=new function e(){var t=this;Object(N.a)(this,e),this.store=void 0,this.setStore=function(e){t.store=e,sessionStorage.setItem(w,JSON.stringify(e))},this.getToken=function(){var e;return null===(e=t.store)||void 0===e?void 0:e.jwt},this.hasPermission=function(e){var n;return null===(n=t.store)||void 0===n?void 0:n.apps.some((function(t){var n=t.name;return e===n}))},this.clear=function(){t.store=null,sessionStorage.removeItem(w)},this.store=JSON.parse(sessionStorage.getItem(w)||"{}")},S=(n(155),n(4)),k=function(){var e=Object(o.g)(),t=Object(r.useState)("EMAIL"),n=Object(j.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(""),i=Object(j.a)(s,2),l=i[0],O=i[1],g=Object(r.useState)(!1),N=Object(j.a)(g,2),w=N[0],k=N[1],C=Object(r.useState)(""),P=Object(j.a)(C,2),E=P[0],T=P[1],_=Object(p.useSnackbar)(),z=Object(r.useState)(!1),D=Object(j.a)(z,2),A=D[0],F=D[1],L=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(!0),e.next=3,x(l);case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,F(!1),t.ok?c("OTP"):_.showMessage("GetOTP failed: "+n.detail);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){var t=Object(d.a)(u.a.mark((function t(){var n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return F(!0),t.next=3,v(l,E);case 3:return n=t.sent,t.next=6,n.json();case 6:r=t.sent,F(!1),n.ok?(y.setStore(r),e.replace("/"+window.location.hash)):(_.showMessage("Login failed: "+r.detail),e.replace("/login"));case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(S.jsxs)("div",{className:"login-screen",children:[Object(S.jsx)("section",{className:"hero",style:{backgroundImage:"url(".concat(f,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat"}}),Object(S.jsx)("section",{children:Object(S.jsxs)("div",{className:"login-container",children:[Object(S.jsxs)("span",{className:"title",children:["CapDev",Object(S.jsx)("b",{children:"Portal"})]}),Object(S.jsxs)("span",{className:"tagline",children:["The Future is ",Object(S.jsx)("i",{children:"Now"})]}),"EMAIL"===a&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("p",{className:"text",children:"Enter your Email Address and we will send you a One-Time Password (OTP) to enter below."}),Object(S.jsxs)("form",{noValidate:!0,autoComplete:"off",children:[Object(S.jsx)("div",{className:"row",children:Object(S.jsx)(h.a,{className:"textfield",required:!0,type:"email",label:"Email",variant:"outlined",placeholder:"e.g. glenn@dsaid.gov.sg",onChange:function(e){var t;O(e.target.value),t=e.target.value,/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/.test(t.toUpperCase())?k(!1):k(!0)},error:w,helperText:w&&"Invalid Email"})}),Object(S.jsxs)("div",{className:"row",children:[Object(S.jsxs)(b.a,{className:"get-otp",size:"large",color:"primary",variant:"contained",disabled:0===l.length||w,onClick:function(){return L()},children:[Object(S.jsx)("b",{children:"GET OTP"}),"\xa0",A&&Object(S.jsx)(m.a,{size:24,color:"inherit"})]}),Object(S.jsxs)("div",{className:"text register",children:[Object(S.jsx)("span",{children:"Not a registered user yet?"}),Object(S.jsx)("br",{}),Object(S.jsx)("a",{href:"#",children:"Contact Us."})]})]})]})]}),"OTP"===a&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("p",{className:"text",children:"An OTP has been emailed to you. Enter OTP below."}),Object(S.jsxs)("form",{noValidate:!0,autoComplete:"off",children:[Object(S.jsx)("div",{className:"row",children:Object(S.jsx)(h.a,{className:"textfield",autoComplete:"one-time-code",required:!0,type:"text",label:"One-Time Password",variant:"outlined",placeholder:"OTP",inputProps:{maxLength:5},onChange:function(e){T(e.target.value)}})}),Object(S.jsxs)("div",{className:"row",children:[Object(S.jsxs)(b.a,{size:"large",color:"primary",variant:"contained",onClick:function(){return I()},children:[Object(S.jsx)("b",{children:"LOGIN"}),"\xa0",A&&Object(S.jsx)(m.a,{size:24,color:"inherit"})]}),Object(S.jsx)(b.a,{className:"resend",size:"large",onClick:function(){return L()},children:"RESEND OTP"})]})]})]})]})})]})},C=n(119),P=n.n(C),E=(n(159),function(){var e=Object(o.g)();return Object(S.jsx)("header",{children:Object(S.jsxs)("div",{className:"content",children:[Object(S.jsxs)("div",{className:"title",onClick:function(){e.push("/")},children:["CapDev",Object(S.jsx)("b",{children:"Portal"})]}),Object(S.jsx)("div",{className:"logout",children:Object(S.jsx)(b.a,{color:"default",size:"large",endIcon:Object(S.jsx)(P.a,{fontSize:"inherit"}),onClick:function(){e.replace("/logout")},children:"Log Out"})})]})})}),T=n(20),_=n(220),z=n(221),D=n(222),A=n(223),F=n(176),L=function(e){var t=e.title,n=e.img,r=e.name,a=Object(o.g)();return Object(S.jsx)(_.a,{onClick:function(){y.hasPermission(r)&&a.replace("/"+r)},className:y.hasPermission(r)?"":"disabled",children:Object(S.jsxs)(z.a,{children:[Object(S.jsx)(D.a,{image:n,title:t}),Object(S.jsx)(A.a,{children:Object(S.jsx)(F.a,{gutterBottom:!0,variant:"h5",component:"h2",children:t})})]})})},I=(n(164),n(228)),W={title:"Project 1",name:"project1",desc:"a dummy project for testing permissions"},J=function(){var e=Object(r.useState)(),t=Object(j.a)(e,2),n=t[0],a=t[1],c=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,t.ok&&a([].concat(Object(T.a)(n.apps),[W]));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){c()}),[]),Object(S.jsx)(S.Fragment,{children:n&&n.length?Object(S.jsx)("div",{className:"dashboard-container",children:null===n||void 0===n?void 0:n.map((function(e){return Object(S.jsx)(L,{name:e.name,title:e.title,img:"https://picsum.photos/id/4/300/200"},e.name)}))}):Object(S.jsx)(I.a,{open:!0,children:Object(S.jsx)(m.a,{size:64,color:"inherit"})})})},R=n(53),M=n(229),V=n(224),B=n(226),G=n(120),U=n(225),H=function(){var e=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://u7yhkrlx15.execute-api.ap-southeast-1.amazonaws.com"+t,Object(R.a)(Object(R.a)({},n),{},{headers:Object(R.a)(Object(R.a)({},n.headers),{},{authorization:"Bearer ".concat(y.getToken()),"Content-Type":"application/json"})}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Z=function(){var e=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H("/v1/profiles/fetch_by_json",{method:"POST",body:JSON.stringify({emails:t,emp_nums:n})});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),q=function(){var e=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H("/v1/profiles/fetch_by_csv",{method:"POST",body:JSON.stringify({emails:t,emp_nums:n})});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Q=(n(165),function(){var e=Object(r.useState)(0),t=Object(j.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)([]),s=Object(j.a)(c,2),i=s[0],o=s[1],l=Object(r.useState)([]),p=Object(j.a)(l,2),f=p[0],O=p[1],x=Object(r.useState)(),v=Object(j.a)(x,2),g=v[0],N=v[1],w=Object(r.useState)(!1),y=Object(j.a)(w,2),k=y[0],C=y[1],P=function(){var e=Object(d.a)(u.a.mark((function e(){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),e.next=3,Z(i,f);case 3:return t=e.sent,e.next=6,t.json();case 6:r=e.sent,C(!1),t.ok&&(N(r),a(n+1));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),e.next=3,q(i,f);case 3:return t=e.sent,e.next=6,t.text();case 6:n=e.sent,C(!1),t.ok&&(r=window.URL.createObjectURL(new Blob([n])),(a=document.createElement("a")).href=r,a.setAttribute("download",String((new Date).valueOf())+".csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(e){return e.replaceAll("\n"," ").trim().split(/[ ,;]+/)},_=function(e){return e.filter((function(e){return""!==e}))};return Object(S.jsxs)("div",{className:"staff-profile-container",children:[Object(S.jsx)("div",{className:"title",children:"Staff Profile Fetcher"}),Object(S.jsx)("div",{className:"stepper-container",children:Object(S.jsx)(M.a,{activeStep:n,alternativeLabel:!0,children:["Upload Data","Download"].map((function(e){return Object(S.jsx)(V.a,{children:Object(S.jsx)(B.a,{children:e})},e)}))})}),0===n&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("p",{className:"text",children:["Enter list of emails and/or employee numbers to search.",Object(S.jsx)("br",{}),"(Deliminate each record by white space or comma or semicolon)"]}),Object(S.jsxs)("div",{className:"input-container",children:[Object(S.jsx)(h.a,{label:"Emails",multiline:!0,rows:15,variant:"outlined",onChange:function(e){return o(T(e.target.value))},defaultValue:i.join("\n")}),Object(S.jsx)(h.a,{label:"Employee Numbers",multiline:!0,rows:15,variant:"outlined",onChange:function(e){return O(T(e.target.value))},defaultValue:f.join("\n")})]})]}),1===n&&g&&(!!_(g.missing_emails).length||!!_(g.missing_emp_nums).length)&&Object(S.jsxs)("div",{className:"error-results-container",children:[Object(S.jsx)("div",{className:"error-text",children:"List of emails and/or employee numbers not found"}),Object(S.jsxs)("div",{className:"error-table-container",children:[!!_(g.missing_emails).length&&Object(S.jsxs)("div",{className:"error-table",children:[Object(S.jsx)("div",{className:"error-header",children:"Email Address"}),g.missing_emails.map((function(e){return Object(S.jsx)("div",{className:"error-row",children:e},e)}))]}),!!_(g.missing_emp_nums).length&&Object(S.jsxs)("div",{className:"error-table",children:[Object(S.jsx)("div",{className:"error-header",children:"Employee No."}),g.missing_emp_nums.map((function(e){return Object(S.jsx)("div",{className:"error-row",children:e},e)}))]})]})]}),1===n&&g&&!!g.profiles.length&&Object(S.jsxs)("div",{className:"profiles-container",children:[Object(S.jsx)("div",{className:"profiles-text",children:"Found Profiles"}),Object(S.jsx)("div",{style:{display:"flex",height:"100%",width:"100%"},children:Object(S.jsx)("div",{style:{flexGrow:1},children:Object(S.jsx)(G.a,{disableSelectionOnClick:!0,autoHeight:!0,columns:[{field:"Display Name",headerName:"Display Name",minWidth:200,flex:1},{field:"Email",headerName:"Email Address",minWidth:200,flex:1},{field:"Employee Number",headerName:"Employee No.",minWidth:200,flex:1},{field:"Reporting Officer",headerName:"Reporting Officer",minWidth:200,flex:1},{field:"Division",headerName:"Division",minWidth:200,flex:1},{field:"Employee Group",headerName:"Employee Group",minWidth:200,flex:1},{field:"HQ/SVC",headerName:"HQ/SVC",minWidth:200,flex:1},{field:"Manager",headerName:"Manager",minWidth:200,flex:1},{field:"Org Chain",headerName:"Org Chain",minWidth:200,flex:1}],rows:g.profiles.map((function(e,t){return Object(R.a)(Object(R.a)({},e),{},{id:t})}))})})})]}),Object(S.jsxs)("div",{className:"button-container",children:[Object(S.jsx)(b.a,{size:"large",onClick:function(){0!==n&&a(n-1)},disabled:k,children:"BACK"}),0===n&&Object(S.jsxs)(b.a,{color:"primary",variant:"contained",size:"large",onClick:function(){return P()},disabled:k,children:["NEXT\xa0",k&&Object(S.jsx)(m.a,{size:24,color:"inherit"})]}),1===n&&Object(S.jsxs)(b.a,{color:"primary",variant:"contained",size:"large",startIcon:Object(S.jsx)(U.a,{}),onClick:function(){return E()},disabled:k||!(null===g||void 0===g?void 0:g.profiles.length),children:["DOWNLOAD CSV\xa0",k&&Object(S.jsx)(m.a,{size:24,color:"inherit"})]})]})]})});var K=function(){return Object(S.jsx)(p.SnackbarProvider,{SnackbarProps:{autoHideDuration:4e3},children:Object(S.jsxs)(i.a,{basename:"/govtest",children:[Object(S.jsxs)(o.d,{children:[Object(S.jsx)(o.b,{path:"/login",render:function(e){return!!y.getToken()&&e.history.replace("/"),Object(S.jsx)(k,{})}}),Object(S.jsx)(o.b,{path:"/logout",render:function(){return y.clear(),Object(S.jsx)(o.a,{to:"/login"})}})]}),Object(S.jsx)(X,{children:Object(S.jsx)(o.b,{render:function(){return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(E,{}),Object(S.jsx)("div",{className:"main",children:Object(S.jsxs)(o.d,{children:[Object(S.jsx)(o.b,{path:"/staff_profiles",component:Q}),Object(S.jsx)(o.b,{path:"/",component:J})]})})]})}})})]})})},X=function(e){var t=e.children;return!!y.getToken()?Object(S.jsx)(S.Fragment,{children:t}):Object(S.jsx)(o.a,{to:"/login"})},Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,230)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};s.a.render(Object(S.jsx)(a.a.StrictMode,{children:Object(S.jsx)(K,{})}),document.getElementById("root")),Y()}},[[168,1,2]]]);
//# sourceMappingURL=main.2f7a6caf.chunk.js.map